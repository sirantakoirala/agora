{"ast":null,"code":"var _jsxFileName = \"D:\\\\firebase-moodle\\\\moodle\\\\src\\\\components\\\\Registration\\\\SignUp.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState } from \"react\";\nimport { Button, Form, Header, Image, Loader, Dimmer, Message, Segment, Check, Checkbox } from \"semantic-ui-react\";\nimport AgoraLogo from \"../../images/logo.png\";\nimport { useUserContext } from \"../../context/userContext\";\nimport { addDoc, collection, setDoc, doc, arrayRemove } from \"firebase/firestore\";\nimport { db } from \"../../firebase-config\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst initialState = {\n  firstName: \"\",\n  lastName: \"\",\n  email: \"\",\n  phoneNumber: \"\",\n  password: \"\",\n  confirmPassword: \"\",\n  role: \"student\",\n  birthdate: \"\",\n  address: \"\"\n};\n\nconst setUpUserRoleOnSignUp = async (userId, email, userName, phoneNumber, address, birthDate, strole) => {\n  console.log(\"AAA\" + userId);\n\n  try {\n    const userCollRef = doc(db, \"users\", userId);\n    console.log(strole);\n    await setDoc(userCollRef, {\n      role: strole,\n      uid: userId,\n      uname: userName,\n      email: email,\n      address: address,\n      birthdate: birthDate,\n      phone: phoneNumber,\n      birthdate: birthDate,\n      approval: \"No\",\n      history: arrayRemove()\n    });\n  } catch (err) {\n    console.log(err);\n  }\n};\n\nexport const SignUp = () => {\n  _s();\n\n  const [formState, setFormState] = useState(initialState);\n  const {\n    signUp,\n    currentUser\n  } = useUserContext();\n  const [passValid, setPassValid] = useState(true);\n  const [passAndConfirmPass, setPassAndConfirmPass] = useState(true);\n\n  const handleChange = ev => {\n    setFormState(prev => ({ ...prev,\n      [ev.target.id]: ev.target.value\n    }));\n  };\n\n  const handleChangeTeacher = ev => {\n    setFormState(prev => ({ ...prev,\n      [ev.target.id]: ev.target.checked == 0 ? \"student\" : \"teacher\"\n    }));\n  };\n\n  const [isSignUpInProgress, setIsSignUpInProgress] = useState(false);\n  const [isSuccess, setIsSuccess] = useState(false);\n  const [emailError, setEmailError] = useState(false);\n\n  const handleSignUp = async ev => {\n    ev.preventDefault();\n    console.log(formState.isTeacher);\n\n    if (formState.firstName == \"\" || formState.lastName == \"\" || formState.email === \"\" || formState.phoneNumber == \"\" || formState.password === \"\" || formState.confirmPassword === \"\") {\n      return;\n    }\n\n    if (formState.confirmPassword !== formState.password) {\n      setPassAndConfirmPass(false);\n      return;\n    }\n\n    if (!formState.password.match(/^(?=.*?[A-Z])(?=.*?[a-z])(?=.*?[0-9])(?=.*?[#?!@$%^&*-]).{8,}$/g)) {\n      setPassValid(false);\n      return;\n    }\n\n    try {\n      setIsSignUpInProgress(true);\n      const {\n        user\n      } = await signUp(formState.email, formState.password);\n      console.log(\"KKK\"); //userId, email ,userName,phoneNumber, address, birthDate,strole\n\n      await setUpUserRoleOnSignUp(user.uid, formState.email, formState.firstName + \" \" + formState.lastName, formState.phoneNumber, formState.address, formState.birthdate, formState.role);\n      setFormState(initialState);\n      setIsSignUpInProgress(false);\n      setIsSuccess(true);\n    } catch {\n      setEmailError(true);\n      setIsSuccess(false);\n      setIsSignUpInProgress(false);\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [emailError && /*#__PURE__*/_jsxDEV(Message, {\n      error: true,\n      header: \"Email is already taken! \\r \"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 9\n    }, this), !passAndConfirmPass && passValid && /*#__PURE__*/_jsxDEV(Message, {\n      error: true,\n      header: \"Your password dont match. Please try again!\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 9\n    }, this), !passValid && /*#__PURE__*/_jsxDEV(Message, {\n      error: true,\n      header: \"Your password doesn't meet the requirement\",\n      content: \"It must contain a minimum 8 characters, one uppercase, one lowercase, one digit and a special character\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(Header, {\n      as: \"h2\",\n      color: \"teal\",\n      textAlign: \"center\",\n      children: [/*#__PURE__*/_jsxDEV(Image, {\n        src: AgoraLogo\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 9\n      }, this), \"Agora\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 7\n    }, this), isSuccess && /*#__PURE__*/_jsxDEV(Message, {\n      success: true,\n      header: \"Your user registration was successful\",\n      content: \"You may now log-in with the username you have chosen\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(Form, {\n      size: \"large\",\n      onSubmit: handleSignUp,\n      children: /*#__PURE__*/_jsxDEV(Segment, {\n        stacked: true,\n        children: [/*#__PURE__*/_jsxDEV(Form.Group, {\n          widths: \"equal\",\n          children: [/*#__PURE__*/_jsxDEV(Form.Input, {\n            fluid: true,\n            icon: \"user\",\n            iconPosition: \"left\",\n            placeholder: \"First name\",\n            id: \"firstName\",\n            onChange: handleChange\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 151,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Form.Input, {\n            fluid: true,\n            iconPosition: \"left\",\n            placeholder: \"Last Name\",\n            id: \"lastName\",\n            onChange: handleChange\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 159,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 150,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(Form.Input, {\n          fluid: true,\n          icon: \"mail\",\n          iconPosition: \"left\",\n          placeholder: \"E-mail address\",\n          id: \"email\",\n          onChange: handleChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 167,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Form.Input, {\n          fluid: true,\n          icon: \"phone\",\n          iconPosition: \"left\",\n          placeholder: \"Phone Number\",\n          type: \"tel\",\n          onChange: handleChange,\n          id: \"phoneNumber\",\n          onKeyPress: event => {\n            if (!/[0-9]/.test(event.key)) {\n              event.preventDefault();\n            }\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 175,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Form.Input, {\n          fluid: true,\n          icon: \"address card\",\n          iconPosition: \"left\",\n          id: \"address\",\n          type: \"address\",\n          placeholder: \"Address\",\n          onChange: handleChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 189,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Form.Input, {\n          fluid: true,\n          icon: \"calendar\",\n          iconPosition: \"left\",\n          id: \"birthdate\",\n          type: \"date\",\n          onChange: handleChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 198,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Form.Input, {\n          fluid: true,\n          icon: \"lock\",\n          iconPosition: \"left\",\n          placeholder: \"Password\",\n          onChange: handleChange,\n          type: \"password\",\n          id: \"password\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 206,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Form.Input, {\n          fluid: true,\n          icon: \"lock\",\n          iconPosition: \"left\",\n          placeholder: \"Confirm Password\",\n          onChange: handleChange,\n          type: \"password\",\n          id: \"confirmPassword\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 215,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Form.Checkbox, {\n          label: \"Teacher\",\n          id: \"role\",\n          onChange: handleChangeTeacher\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 224,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          color: \"teal\",\n          fluid: true,\n          size: \"large\",\n          type: \"submit\",\n          children: isSignUpInProgress ? /*#__PURE__*/_jsxDEV(Dimmer, {\n            active: true,\n            children: /*#__PURE__*/_jsxDEV(Loader, {\n              size: \"mini\",\n              children: \"Loading\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 232,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 231,\n            columnNumber: 15\n          }, this) : \"Sign up\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 229,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 149,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n};\n\n_s(SignUp, \"LORlcNZYrXuefOCU8xPbbGT6igk=\", false, function () {\n  return [useUserContext];\n});\n\n_c = SignUp;\n\nvar _c;\n\n$RefreshReg$(_c, \"SignUp\");","map":{"version":3,"sources":["D:/firebase-moodle/moodle/src/components/Registration/SignUp.js"],"names":["React","useState","Button","Form","Header","Image","Loader","Dimmer","Message","Segment","Check","Checkbox","AgoraLogo","useUserContext","addDoc","collection","setDoc","doc","arrayRemove","db","initialState","firstName","lastName","email","phoneNumber","password","confirmPassword","role","birthdate","address","setUpUserRoleOnSignUp","userId","userName","birthDate","strole","console","log","userCollRef","uid","uname","phone","approval","history","err","SignUp","formState","setFormState","signUp","currentUser","passValid","setPassValid","passAndConfirmPass","setPassAndConfirmPass","handleChange","ev","prev","target","id","value","handleChangeTeacher","checked","isSignUpInProgress","setIsSignUpInProgress","isSuccess","setIsSuccess","emailError","setEmailError","handleSignUp","preventDefault","isTeacher","match","user","event","test","key"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\r\nimport {\r\n  Button,\r\n  Form,\r\n  Header,\r\n  Image,\r\n  Loader,\r\n  Dimmer,\r\n  Message,\r\n  Segment,\r\n  Check, \r\n  Checkbox,\r\n} from \"semantic-ui-react\";\r\nimport AgoraLogo from \"../../images/logo.png\";\r\nimport { useUserContext } from \"../../context/userContext\";\r\nimport { addDoc, collection,setDoc,doc, arrayRemove } from \"firebase/firestore\";\r\nimport { db } from \"../../firebase-config\";\r\n\r\nconst initialState = {\r\n  firstName: \"\",\r\n  lastName:\"\",\r\n  email: \"\",\r\n  phoneNumber:\"\",\r\n  password: \"\",\r\n  confirmPassword: \"\",\r\n  role: \"student\",\r\n  birthdate:\"\",\r\n  address:\"\",\r\n};\r\n\r\nconst setUpUserRoleOnSignUp = async (userId, email ,userName,phoneNumber, address, birthDate,strole) => {\r\n  console.log(\"AAA\"+userId);\r\n  try\r\n  {\r\n    const userCollRef = doc(db, \"users\" , userId);\r\n    console.log(strole);\r\n    await setDoc(userCollRef, {\r\n      role: strole,\r\n      uid: userId,\r\n      uname: userName,\r\n      email: email,\r\n      address: address,\r\n      birthdate:birthDate,\r\n      phone: phoneNumber,\r\n      birthdate: birthDate,\r\n      approval :\"No\",\r\n      history: arrayRemove(),\r\n    });\r\n  } catch(err)\r\n  {\r\n    console.log(err);\r\n  }\r\n};\r\n\r\nexport const SignUp = () => {\r\n  const [formState, setFormState] = useState(initialState);\r\n  const { signUp, currentUser } = useUserContext();\r\n  const [passValid, setPassValid] = useState(true);\r\n  const [passAndConfirmPass, setPassAndConfirmPass] = useState(true);\r\n  const handleChange = (ev) => {\r\n    setFormState((prev) => ({ ...prev, [ev.target.id]: ev.target.value }));\r\n  };\r\n  const handleChangeTeacher = (ev) => {\r\n    setFormState((prev) => ({ ...prev, [ev.target.id]: ev.target.checked == 0 ? \"student\" : \"teacher\" }));\r\n  };\r\n  const [isSignUpInProgress, setIsSignUpInProgress] = useState(false);\r\n  const [isSuccess, setIsSuccess] = useState(false);\r\n  const [emailError, setEmailError] = useState(false);\r\n  const handleSignUp = async (ev) => {\r\n    ev.preventDefault();\r\n    \r\n    console.log(formState.isTeacher);\r\n    if (\r\n      formState.firstName == \"\"||\r\n      formState.lastName == \"\" ||\r\n      formState.email === \"\" ||\r\n      formState.phoneNumber == \"\"||\r\n      formState.password === \"\" ||\r\n      formState.confirmPassword === \"\"\r\n    ) {\r\n      return;\r\n    }\r\n    if (formState.confirmPassword !== formState.password) {\r\n      setPassAndConfirmPass(false);\r\n      return;\r\n    }\r\n\r\n    if (\r\n      !formState.password.match(\r\n        /^(?=.*?[A-Z])(?=.*?[a-z])(?=.*?[0-9])(?=.*?[#?!@$%^&*-]).{8,}$/g\r\n      )\r\n    ) {\r\n      setPassValid(false);\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setIsSignUpInProgress(true);\r\n      const { user } = await signUp(formState.email, formState.password);\r\n      console.log(\"KKK\");\r\n      //userId, email ,userName,phoneNumber, address, birthDate,strole\r\n      await setUpUserRoleOnSignUp(user.uid, formState.email, formState.firstName + \" \" + formState.lastName,formState.phoneNumber,\r\n      formState.address,formState.birthdate,formState.role);\r\n      setFormState(initialState);\r\n      setIsSignUpInProgress(false);\r\n      setIsSuccess(true);\r\n    } catch {\r\n      setEmailError(true);\r\n      setIsSuccess(false);\r\n      setIsSignUpInProgress(false);\r\n    }\r\n  };\r\n  return (\r\n    <>\r\n      {emailError && (\r\n        <Message\r\n          error\r\n          header=\"Email is already taken! \r\n          \r\n          \r\n          \r\n          \"\r\n        />\r\n      )}\r\n      {!passAndConfirmPass && passValid && (\r\n        <Message error header=\"Your password dont match. Please try again!\" />\r\n      )}\r\n      {!passValid && (\r\n        <Message\r\n          error\r\n          header=\"Your password doesn't meet the requirement\"\r\n          content=\"It must contain a minimum 8 characters, one uppercase, one lowercase, one digit and a special character\"\r\n        />\r\n      )}\r\n      <Header as=\"h2\" color=\"teal\" textAlign=\"center\">\r\n        <Image src={AgoraLogo} />\r\n        Agora\r\n      </Header>\r\n\r\n      {isSuccess && (\r\n        <Message\r\n          success\r\n          header=\"Your user registration was successful\"\r\n          content=\"You may now log-in with the username you have chosen\"\r\n        />\r\n      )}\r\n\r\n      <Form size=\"large\" onSubmit={handleSignUp}>\r\n        <Segment stacked>\r\n        <Form.Group widths = 'equal'>\r\n            <Form.Input\r\n              fluid\r\n              icon=\"user\"\r\n              iconPosition=\"left\"\r\n              placeholder=\"First name\"\r\n              id=\"firstName\"\r\n              onChange={handleChange}\r\n            />\r\n            <Form.Input\r\n              fluid\r\n              iconPosition=\"left\"\r\n              placeholder=\"Last Name\"\r\n              id=\"lastName\"\r\n              onChange={handleChange}\r\n            />\r\n          </Form.Group>\r\n          <Form.Input\r\n            fluid\r\n            icon=\"mail\"\r\n            iconPosition=\"left\"\r\n            placeholder=\"E-mail address\"\r\n            id=\"email\"\r\n            onChange={handleChange}\r\n          />\r\n          <Form.Input\r\n            fluid\r\n            icon=\"phone\"\r\n            iconPosition=\"left\"\r\n            placeholder=\"Phone Number\"\r\n            type=\"tel\"\r\n            onChange={handleChange}\r\n            id=\"phoneNumber\"\r\n            onKeyPress={(event) => {\r\n              if (!/[0-9]/.test(event.key)) {\r\n                event.preventDefault();\r\n              }\r\n            }}\r\n          />\r\n          <Form.Input\r\n            fluid\r\n            icon=\"address card\"\r\n            iconPosition=\"left\"\r\n            id=\"address\"\r\n            type=\"address\"\r\n            placeholder=\"Address\"\r\n            onChange={handleChange}\r\n          />\r\n          <Form.Input\r\n            fluid\r\n            icon=\"calendar\"\r\n            iconPosition=\"left\"\r\n            id=\"birthdate\"\r\n            type=\"date\"\r\n            onChange={handleChange}\r\n          />\r\n          <Form.Input\r\n            fluid\r\n            icon=\"lock\"\r\n            iconPosition=\"left\"\r\n            placeholder=\"Password\"\r\n            onChange={handleChange}\r\n            type=\"password\"\r\n            id=\"password\"\r\n          />\r\n          <Form.Input\r\n            fluid\r\n            icon=\"lock\"\r\n            iconPosition=\"left\"\r\n            placeholder=\"Confirm Password\"\r\n            onChange={handleChange}\r\n            type=\"password\"\r\n            id=\"confirmPassword\"\r\n          />\r\n          <Form.Checkbox\r\n          label = \"Teacher\"\r\n          id = \"role\"\r\n          onChange={handleChangeTeacher}\r\n          />\r\n          <Button color=\"teal\" fluid size=\"large\" type=\"submit\">\r\n            {isSignUpInProgress ? (\r\n              <Dimmer active>\r\n                <Loader size=\"mini\">Loading</Loader>\r\n              </Dimmer>\r\n            ) : (\r\n              \"Sign up\"\r\n            )}\r\n          </Button>\r\n        </Segment>\r\n      </Form>\r\n    </>\r\n  );\r\n};\r\n"]},"metadata":{},"sourceType":"module"}